/* static/css/styles.css */

/* --- Consolidated Professional Styles --- */
:root {
    /* Light Theme (Default) */
    --primary: #0d3b66;         /* Deep Blue */
    --secondary: #4a96d3;       /* Medium Blue */
    --accent: #5bc0be;          /* Teal Accent */
    --success: #2ac769;          /* Green */
    --danger: #ee6c4d;           /* Red/Orange */
    --warning: #ffd166;          /* Yellow */
    --light: #f8f9fa;           /* Light Gray */
    --dark: #212529;            /* Dark Gray */
    --gray: #6c757d;            /* Medium Gray */
    --white: #ffffff;

    /* UI Elements - Light */
    --bg-body: #f5f7fa;         /* Very Light Background */
    --bg-card: var(--white);
    --bg-header: var(--white);
    --bg-hover: rgba(74, 150, 211, 0.05); /* Light hover */

    /* Text - Light */
    --text-main: #2c3e50;       /* Dark Text */
    --text-muted: var(--gray);
    --text-heading: var(--primary);
    --text-on-primary: var(--white); /* Text on primary bg */
    --text-on-dark: var(--white); /* Text on dark bg (like ticker tape) */
    --text-link: var(--primary);
    --text-link-hover: var(--secondary);

    /* Borders - Light */
    --border-color: #dee2e6;
    --border-card: rgba(0,0,0,0.08);
    --border-header: rgba(0,0,0,0.05);

    /* Shadows - Light */
    --shadow-card: 0 4px 12px rgba(0,0,0,0.05);
    --shadow-card-hover: 0 8px 16px rgba(0,0,0,0.07);

    /* Specific Elements */
    --ticker-bg: var(--dark);
    --ticker-text: var(--light);
    --ticker-change-positive: var(--success);
    --ticker-change-negative: var(--danger);

    --action-badge-buy-bg: rgba(42, 199, 105, 0.1);
    --action-badge-buy-text: var(--success);
    --action-badge-strong-buy-bg: rgba(42, 199, 105, 0.2);
    --action-badge-strong-buy-text: var(--success);
    --action-badge-sell-bg: rgba(238, 108, 77, 0.1);
    --action-badge-sell-text: var(--danger);
    --action-badge-strong-sell-bg: rgba(238, 108, 77, 0.2);
    --action-badge-strong-sell-text: var(--danger);
    --action-badge-none-bg: rgba(108, 117, 125, 0.1);
    --action-badge-none-text: var(--gray);

    --news-item-sentiment-positive-bg: rgba(42, 199, 105, 0.1);
    --news-item-sentiment-positive-text: var(--success);
    --news-item-sentiment-negative-bg: rgba(238, 108, 77, 0.1);
    --news-item-sentiment-negative-text: var(--danger);
    --news-item-sentiment-neutral-bg: rgba(108, 117, 125, 0.1);
    --news-item-sentiment-neutral-text: var(--gray);

    --price-change-positive-bg: rgba(42, 199, 105, 0.2);
    --price-change-positive-text: #1a7d4f; /* Darker green text */
    --price-change-negative-bg: rgba(238, 108, 77, 0.2);
    --price-change-negative-text: #b34c30; /* Darker red text */

    --theme-toggle-hover-bg: rgba(0, 0, 0, 0.05);
}

/* --- Enhanced Dark Theme Variables --- */
[data-theme="dark"] {
    /* Base Colors - Dark */
    --primary: #4299e1;          /* Brighter Blue for dark bg */
    --secondary: #63b3ed;        /* Lighter Blue */
    --accent: #4fd1c5;           /* Brighter Teal */
    --success: #48bb78;           /* Slightly softer Green */
    --danger: #f56565;            /* Brighter Red */
    --warning: #ffd166;           /* Brighter Yellow */
    --light: #4a5568;            /* Medium Gray (Dark mode "light") */
    --dark: #1a202c;             /* Very Dark Blue/Gray */
    --gray: #a0aec0;             /* Light Gray (Dark mode "gray") */
    --white: #171923;            /* Almost Black (Dark mode "white") */

    /* UI Elements - Dark */
    --bg-body: #1a202c;          /* Darkest Background */
    --bg-card: #2d3748;          /* Dark Gray Card */
    --bg-header: #2d3748;         /* Dark Gray Header */
    --bg-hover: rgba(255, 255, 255, 0.08); /* More visible light hover */

    /* Text - Dark */
    --text-main: #f7fafc;        /* Very Light Gray Text (improved contrast) */
    --text-muted: #cbd5e0;       /* Lighter Gray Muted Text (improved contrast) */
    --text-heading: #ebf8ff;     /* Light Blue Headings (improved contrast) */
    --text-on-primary: #ffffff;  /* White text on primary */
    --text-on-dark: #f7fafc;     /* Very light gray text on dark bg */
    --text-link: var(--accent);  /* Teal links */
    --text-link-hover: #81e6d9;  /* Lighter teal hover */

    /* Borders - Dark */
    --border-color: #4a5568;     /* Medium Gray Border */
    --border-card: rgba(255, 255, 255, 0.1); /* Slightly more visible borders */
    --border-header: rgba(255, 255, 255, 0.08); /* Slightly more visible header borders */

    /* Shadows - Dark (Subtler) */
    --shadow-card: 0 4px 12px rgba(0,0,0,0.25);
    --shadow-card-hover: 0 8px 16px rgba(0,0,0,0.35);

    /* Specific Elements - Dark */
    --ticker-bg: #171923;         /* Use darkest color for ticker */
    --ticker-text: #f7fafc;      /* Brighter ticker text for contrast */
    --ticker-change-positive: #68d391; /* Brighter green for better visibility */
    --ticker-change-negative: #fc8181; /* Brighter red for better visibility */

    --action-badge-buy-bg: rgba(72, 187, 120, 0.2);
    --action-badge-buy-text: #9ae6b4; /* Lighter green text for contrast */
    --action-badge-strong-buy-bg: rgba(72, 187, 120, 0.3);
    --action-badge-strong-buy-text: #9ae6b4; /* Lighter green text for contrast */
    --action-badge-sell-bg: rgba(245, 101, 101, 0.2);
    --action-badge-sell-text: #feb2b2; /* Lighter red text for contrast */
    --action-badge-strong-sell-bg: rgba(245, 101, 101, 0.3);
    --action-badge-strong-sell-text: #feb2b2; /* Lighter red text for contrast */
    --action-badge-none-bg: rgba(160, 174, 192, 0.2);
    --action-badge-none-text: #edf2f7; /* Lighter text for contrast */

    --news-item-sentiment-positive-bg: rgba(72, 187, 120, 0.2);
    --news-item-sentiment-positive-text: #9ae6b4; /* Lighter green text */
    --news-item-sentiment-negative-bg: rgba(245, 101, 101, 0.2);
    --news-item-sentiment-negative-text: #feb2b2; /* Lighter red text */
    --news-item-sentiment-neutral-bg: rgba(160, 174, 192, 0.2);
    --news-item-sentiment-neutral-text: #edf2f7; /* Lighter text */

    --price-change-positive-bg: rgba(72, 187, 120, 0.25);
    --price-change-positive-text: #9ae6b4; /* Lighter green text */
    --price-change-negative-bg: rgba(245, 101, 101, 0.25);
    --price-change-negative-text: #feb2b2; /* Lighter red text */

    --theme-toggle-hover-bg: rgba(255, 255, 255, 0.15);
}

/* Theme Toggle Button */
.theme-toggle-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    margin-right: 0.5rem;
    border-radius: 50%;
    transition: background-color 0.3s;
}

.theme-toggle-btn:hover {
    background-color: var(--theme-toggle-hover-bg);
}

.theme-toggle-btn i {
    font-size: 1.1rem;
    transition: color 0.3s ease;
}

/* Set icon colors directly */
.theme-light-icon {
    color: var(--warning); /* Yellow sun */
}

.theme-dark-icon {
    color: #a0aec0; /* Gray moon */
}

[data-theme="dark"] .theme-dark-icon {
    color: #e2e8f0; /* Lighter moon in dark mode */
}


body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-body); /* Use body background variable */
    color: var(--text-main);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* Navbar */
.navbar {
    background-color: var(--primary);
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.navbar-brand {
    font-weight: 700;
    color: var(--text-on-primary) !important; /* Use variable */
}
.navbar-brand span {
    color: var(--accent);
}
.nav-link {
    color: rgba(255, 255, 255, 0.8) !important; /* Keep light text on dark navbar */
    transition: color 0.2s ease-in-out;
}
.nav-link:hover, .nav-link.active {
    color: var(--text-on-primary) !important; /* Use variable */
}
.nav-link i {
    margin-right: 5px;
}
.navbar-toggler {
    border-color: rgba(255, 255, 255, 0.5);
}
.navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.8%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}
/* Ensure dropdown menu adapts */
.dropdown-menu {
    background-color: var(--bg-card);
    border: 1px solid var(--border-card);
    box-shadow: var(--shadow-card);
}
.dropdown-item {
    color: var(--text-main);
}
.dropdown-item:hover, .dropdown-item:focus {
    background-color: var(--bg-hover);
    color: var(--text-main);
}
.dropdown-divider {
    border-top-color: var(--border-color);
}
/* Dark mode specific dropdown adjustments */
[data-theme="dark"] .dropdown-menu {
    box-shadow: 0 4px 12px rgba(0,0,0,0.4); /* Darker shadow */
}
[data-theme="dark"] .dropdown-item:hover,
[data-theme="dark"] .dropdown-item:focus {
    background-color: rgba(255, 255, 255, 0.08); /* Slightly lighter hover */
}

/* Cards */
.card {
    border: 1px solid var(--border-card); /* Use variable */
    border-radius: 10px;
    box-shadow: var(--shadow-card); /* Use variable */
    margin-bottom: 24px;
    transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s, border-color 0.3s;
    background-color: var(--bg-card); /* Use variable */
    display: flex;
    flex-direction: column;
    color: var(--text-main); /* Ensure text inside card adapts */
}
.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-card-hover); /* Use variable */
}
.card-header {
    font-weight: 600;
    background-color: var(--bg-header); /* Use variable */
    border-bottom: 1px solid var(--border-header); /* Use variable */
    padding: 16px 20px;
    border-radius: 10px 10px 0 0 !important;
    display: flex;
    align-items: center;
    color: var(--text-heading); /* Use variable */
    transition: background-color 0.3s, border-color 0.3s;
}
.card-header i {
    margin-right: 10px;
    color: var(--secondary);
}
.card-body {
    padding: 20px;
    flex-grow: 1;
    transition: background-color 0.3s;
}
/* Target card bodies with p-0 separately */
.card-body.p-0 {
    padding: 0 !important;
}

/* Buttons */
.btn {
     border-radius: 8px;
     padding: 8px 16px;
     font-weight: 500;
     transition: all 0.2s ease-in-out;
}
.btn-lg { padding: 12px 24px; font-size: 1.1rem;}
.btn-sm { padding: 5px 10px; font-size: 0.8rem;}

/* Define button text colors explicitly */
.btn-primary { background-color: var(--primary); border-color: var(--primary); color: var(--text-on-primary); }
.btn-primary:hover { background-color: color-mix(in srgb, var(--primary) 80%, black); border-color: color-mix(in srgb, var(--primary) 80%, black); color: var(--text-on-primary); }
.btn-outline-primary { color: var(--primary); border-color: var(--primary); }
.btn-outline-primary:hover { background-color: var(--primary); color: var(--text-on-primary); }

.btn-success { background-color: var(--success); border-color: var(--success); color: #fff; }
.btn-success:hover { background-color: color-mix(in srgb, var(--success) 85%, black); border-color: color-mix(in srgb, var(--success) 85%, black); color: #fff; }
.btn-outline-success { color: var(--success); border-color: var(--success); }
.btn-outline-success:hover { background-color: var(--success); color: #fff; }

.btn-danger { background-color: var(--danger); border-color: var(--danger); color: #fff; }
.btn-danger:hover { background-color: color-mix(in srgb, var(--danger) 85%, black); border-color: color-mix(in srgb, var(--danger) 85%, black); color: #fff; }
.btn-outline-danger { color: var(--danger); border-color: var(--danger); }
.btn-outline-danger:hover { background-color: var(--danger); color: #fff; }

.btn-info { background-color: var(--accent); border-color: var(--accent); color: #fff; }
.btn-info:hover { background-color: color-mix(in srgb, var(--accent) 85%, black); border-color: color-mix(in srgb, var(--accent) 85%, black); color: #fff; }
.btn-outline-info { color: var(--accent); border-color: var(--accent); }
.btn-outline-info:hover { background-color: var(--accent); color: #fff; }

/* Warning button text color needs careful handling based on theme */
.btn-warning { background-color: var(--warning); border-color: var(--warning); color: #444; } /* Darker text for light theme */
.btn-warning:hover { background-color: color-mix(in srgb, var(--warning) 85%, black); border-color: color-mix(in srgb, var(--warning) 85%, black); color: #444; }
.btn-outline-warning { color: var(--warning); border-color: var(--warning); }
.btn-outline-warning:hover { background-color: var(--warning); color: #444; }

[data-theme="dark"] .btn-warning { color: #1a202c; } /* Dark text for dark theme */
[data-theme="dark"] .btn-warning:hover { color: #1a202c; }
[data-theme="dark"] .btn-outline-warning:hover { color: #1a202c; }

.btn-dark { background-color: var(--dark); border-color: var(--dark); color: var(--text-on-dark); }
.btn-dark:hover { background-color: color-mix(in srgb, var(--dark) 85%, black); border-color: color-mix(in srgb, var(--dark) 85%, black); color: var(--text-on-dark); }

.btn-light { background-color: var(--light); border-color: var(--border-color); color: var(--text-main); }
.btn-light:hover { background-color: color-mix(in srgb, var(--light) 90%, black); border-color: color-mix(in srgb, var(--border-color) 90%, black); }
.btn-outline-light { color: var(--light); border-color: var(--light); } /* Less common */
.btn-outline-light:hover { background-color: var(--light); color: var(--primary); }

.btn-link { color: var(--text-link); text-decoration: none; font-weight: 500;}
.btn-link:hover { color: var(--text-link-hover); text-decoration: underline;}


/* Forms */
.form-control {
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    background-color: var(--bg-card); /* Use card bg for inputs */
    color: var(--text-main);
    transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s, color 0.3s;
}
.form-control::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
}
.form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.25rem color-mix(in srgb, var(--primary) 25%, transparent); /* Adjusted focus ring */
    background-color: var(--bg-card); /* Keep bg on focus */
    color: var(--text-main); /* Keep text color on focus */
}
.form-label { font-weight: 500; margin-bottom: 5px; color: var(--text-muted);}
.input-group-text {
    background-color: color-mix(in srgb, var(--bg-body) 80%, var(--border-color) 20%); /* Blend bg and border */
    border: 1px solid var(--border-color);
    color: var(--text-muted);
}

/* Improve form controls in dark mode */
[data-theme="dark"] .form-control {
    background-color: color-mix(in srgb, var(--bg-card) 95%, black 5%); /* Slightly darker for better distinction */
    border-color: var(--border-color);
    color: var(--text-main);
}

[data-theme="dark"] .form-control:focus {
    background-color: color-mix(in srgb, var(--bg-card) 90%, black 10%); /* Even darker when focused */
    border-color: var(--primary);
    color: var(--text-main);
}

[data-theme="dark"] .form-control::placeholder {
    color: var(--text-muted);
    opacity: 0.8;
}

[data-theme="dark"] .form-text {
    color: #cbd5e0 !important; /* Brighter and more visible help text */
}

[data-theme="dark"] .input-group-text {
    background-color: color-mix(in srgb, var(--bg-header) 95%, var(--primary) 5%);
    color: var(--text-heading);
    border-color: var(--border-color);
}

/* Tables */
.table {
    border-collapse: separate;
    border-spacing: 0;
    width: 100%;
    color: var(--text-main);
    transition: color 0.3s, background-color 0.3s, border-color 0.3s;
    background-color: transparent; /* Ensure table itself isn't overriding */
}
.table thead th {
    border-bottom: 2px solid var(--border-color);
    background-color: var(--bg-header);
    color: var(--text-muted);
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.8rem;
    letter-spacing: 0.5px;
    white-space: nowrap;
    vertical-align: middle;
    padding: 12px 15px;
    transition: background-color 0.3s, border-color 0.3s, color 0.3s;
}
.table tbody tr {
    border-bottom: 1px solid var(--border-color);
    transition: background-color 0.2s, border-color 0.2s, color 0.2s;
    vertical-align: middle;
}
.table tbody tr:last-child { border-bottom: none; }
.table tbody tr:hover { background-color: var(--bg-hover); }
.table td { padding: 12px 15px; }

/* Badges */
.badge { padding: 6px 10px; font-weight: 500; font-size: 0.85rem; border-radius: 15px; }
/* Ensure text color contrasts with background */
.badge.bg-success, .badge.bg-danger, .badge.bg-info, .badge.bg-primary { color: #fff; }
.badge.bg-warning { color: #444; }
.badge.bg-light { color: var(--text-main); }
.badge.bg-dark { color: var(--text-on-dark); }
.badge.bg-secondary { color: var(--text-on-primary); } /* Assuming secondary is dark enough */
[data-theme="dark"] .badge.bg-warning { color: #1a202c; } /* Dark text on warning in dark mode */
[data-theme="dark"] .badge.bg-secondary { color: #e2e8f0; } /* Light text on secondary in dark mode */
[data-theme="dark"] .badge.bg-light { color: var(--text-main); } /* Light text on "light" (dark gray) bg */

/* List Groups */
.list-group-item {
    border: none; /* Remove default borders */
    border-bottom: 1px solid var(--border-color);
    padding: 16px 20px;
    transition: background-color 0.2s, border-color 0.2s, color 0.2s;
    background-color: transparent; /* Use card bg */
    color: var(--text-main);
}
.list-group-item:last-child { border-bottom: none; }
.list-group-flush .list-group-item { border-width: 0 0 1px; }
.list-group-flush:last-child .list-group-item:last-child { border-width: 0; }
.list-group-item:hover { background-color: var(--bg-hover); }
.list-group-item strong { color: var(--primary); }
.list-group-item a { color: var(--text-link); }
.list-group-item a:hover { color: var(--text-link-hover); }

/* Ensure background is correct */
.list-group {
    background-color: var(--bg-card);
}
.card > .list-group:last-child .list-group-item:last-child {
    border-bottom-right-radius: var(--bs-card-inner-border-radius); /* Check if Bootstrap var is available or use hardcoded */
    border-bottom-left-radius: var(--bs-card-inner-border-radius); /* Check if Bootstrap var is available or use hardcoded */
    /* Fallback */
    border-bottom-right-radius: calc(10px - 1px);
    border-bottom-left-radius: calc(10px - 1px);
}

/* Action Badge Specific Styles */
.action-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: capitalize;
    display: inline-block;
    min-width: 80px;
    text-align: center;
}
.action-badge.buy { background-color: var(--action-badge-buy-bg); color: var(--action-badge-buy-text); }
.action-badge.strong_buy { background-color: var(--action-badge-strong-buy-bg); color: var(--action-badge-strong-buy-text); }
.action-badge.sell { background-color: var(--action-badge-sell-bg); color: var(--action-badge-sell-text); }
.action-badge.strong_sell { background-color: var(--action-badge-strong-sell-bg); color: var(--action-badge-strong-sell-text); }
.action-badge.none { background-color: var(--action-badge-none-bg); color: var(--action-badge-none-text); }

/* Dashboard Specific */
.welcome-card {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: var(--text-on-primary);
    border-radius: 10px;
    padding: 30px;
    margin-bottom: 30px;
}
.welcome-card h2 { font-weight: 700; margin-bottom: 10px; }
.welcome-card p { opacity: 0.9; margin-bottom: 0; }
[data-theme="dark"] .welcome-card {
     background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); /* Darker gradient */
}

.ticker-container {
    background-color: var(--ticker-bg);
    color: var(--ticker-text);
    padding: 10px 0;
    overflow: hidden;
    white-space: nowrap;
    margin-bottom: 24px;
    border-radius: 5px;
}
.ticker-tape { display: inline-block; animation: ticker 60s linear infinite; padding-left: 100%; }
.ticker-item { display: inline-block; padding: 0 25px; }
.ticker-symbol { font-weight: 600; margin-right: 8px; opacity: 0.8; }
.ticker-price { margin-right: 8px; }
.ticker-change { font-size: 0.9em; }
.ticker-change.positive { color: var(--ticker-change-positive); }
.ticker-change.negative { color: var(--ticker-change-negative); }
@keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

.stats-card { text-align: center; padding: 20px; height: 100%; }
.stats-card i { font-size: 2.2rem; color: var(--secondary); margin-bottom: 15px; display: block; }
.stats-card h3 { font-size: 1.8rem; font-weight: 700; margin-bottom: 5px; color: var(--text-heading); }
.stats-card p { color: var(--text-muted); margin-bottom: 0; font-size: 0.9rem; }

/* Analysis Page Specific */
.stock-header {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: var(--text-on-primary);
    border-radius: 10px; padding: 30px; margin-bottom: 30px;
    position: relative; overflow: hidden;
}
.stock-header::after { /* Subtle pattern for dark mode */
    content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
    background-size: 10px 10px;
    opacity: 0.03;
    z-index: 0;
    display: none; /* Hide by default */
}
[data-theme="dark"] .stock-header {
    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); /* Darker gradient */
}
[data-theme="dark"] .stock-header::after {
    display: block; /* Show pattern only in dark mode */
}
.stock-header .row { position: relative; z-index: 1; }
.stock-header h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 5px; }
.stock-header .company-name { font-size: 1rem; opacity: 0.8; margin-bottom: 15px; }
.price-large { font-size: 2.8rem; font-weight: 700; margin-bottom: 5px; }
.price-change {
    font-size: 1.1rem; margin-bottom: 0; display: inline-block;
    padding: 5px 12px; border-radius: 20px;
    background-color: var(--price-change-positive-bg); /* Default to positive */
    color: var(--price-change-positive-text);
}
.price-change.negative {
    background-color: var(--price-change-negative-bg);
    color: var(--price-change-negative-text);
}


.metric-card { padding: 15px; border-radius: 10px; margin-bottom: 20px; display: flex; align-items: center; }
.metric-card .icon { font-size: 1.6rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; border-radius: 50%; margin-right: 15px; color: white; flex-shrink: 0; }
.metric-card .content h3 { font-size: 1.2rem; font-weight: 700; margin-bottom: 0; color: var(--text-heading); } /* Adjusted color */
.metric-card .content p { margin-bottom: 0; color: var(--text-muted); font-size: 0.9rem; }
/* Backgrounds adjusted for subtlety */
.metric-positive { background-color: color-mix(in srgb, var(--success) 5%, transparent); } .metric-positive .icon { background-color: var(--success); }
.metric-negative { background-color: color-mix(in srgb, var(--danger) 5%, transparent); } .metric-negative .icon { background-color: var(--danger); }
.metric-neutral { background-color: color-mix(in srgb, var(--gray) 5%, transparent); } .metric-neutral .icon { background-color: var(--gray); }
.metric-warning { background-color: color-mix(in srgb, var(--warning) 5%, transparent); } .metric-warning .icon { background-color: var(--warning); color: #444 } /* Dark text for warning icon */
[data-theme="dark"] .metric-warning .icon { color: #1a202c; } /* Dark text for warning icon */


.action-btn-group { display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap; }
.action-btn { flex: 1 1 auto; min-width: 120px; font-weight: 600; padding: 12px 10px; border-radius: 10px; text-align: center; transition: all 0.3s; border: 2px solid transparent; }
.action-btn i { display: block; margin-bottom: 5px; font-size: 1.3rem; }
.action-btn small { font-size: 0.8em; color: var(--text-muted); } /* Use variable */
.action-btn:hover { transform: translateY(-3px); }
.action-btn.active { border-color: var(--primary); box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 30%, transparent); } /* Add subtle glow */
.action-btn.set-action.btn-success.active { border-color: var(--success); box-shadow: 0 0 0 2px color-mix(in srgb, var(--success) 30%, transparent); }
.action-btn.set-action.btn-primary.active { border-color: var(--primary); box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 30%, transparent);}
.action-btn.set-action.btn-danger.active { border-color: var(--danger); box-shadow: 0 0 0 2px color-mix(in srgb, var(--danger) 30%, transparent);}
.action-btn.set-action.btn-dark.active { border-color: var(--dark); box-shadow: 0 0 0 2px color-mix(in srgb, var(--dark) 30%, transparent);}

.target-price { display: flex; align-items: center; justify-content: center; color: white; border-radius: 10px; padding: 15px 20px; margin-bottom: 20px; text-align: center; }
.target-price.positive { background: linear-gradient(135deg, var(--success) 0%, color-mix(in srgb, var(--success) 80%, black) 100%); }
.target-price.negative { background: linear-gradient(135deg, var(--danger) 0%, color-mix(in srgb, var(--danger) 80%, black) 100%); }
.target-price .price { font-size: 1.8rem; font-weight: 700; margin-right: 15px; flex-shrink: 0; }
.target-price .change { font-size: 1.1rem; text-align: left; }
.target-price .change small { font-size: 0.85rem; display: block; opacity: 0.8; }

.prediction-chart { width: 100%; height: auto; min-height: 300px; background-color: var(--bg-card); border-radius: 10px; overflow: hidden; margin-bottom: 20px; }
.prediction-chart img { display: block; max-width: 100%; height: auto; border-radius: 10px; }
/* Placeholder styling */
.prediction-chart.bg-light { background-color: var(--bg-hover) !important; }
.prediction-chart .text-muted { color: var(--text-muted) !important; }

/* News items */
.ticker-news { background-color: var(--bg-card); border-radius: 10px; padding: 0; margin-bottom: 20px; overflow: hidden; }
.news-item { padding: 15px 20px; border-bottom: 1px solid var(--border-color); }
.news-item:last-child { border-bottom: none; }
.news-item .title { font-weight: 600; margin-bottom: 5px; color: var(--text-main); text-decoration: none; display: block; }
.news-item .title:hover { color: var(--text-link-hover); }
.news-item .source { font-size: 0.85rem; color: var(--text-muted); margin-right: 10px; }
.news-item .date { font-size: 0.85rem; color: var(--text-muted); }
.news-item .sentiment { display: inline-block; padding: 3px 8px; border-radius: 15px; font-size: 0.75rem; font-weight: 600; margin-left: 10px; text-transform: capitalize; }
.news-item .sentiment.positive { background-color: var(--news-item-sentiment-positive-bg); color: var(--news-item-sentiment-positive-text); }
.news-item .sentiment.negative { background-color: var(--news-item-sentiment-negative-bg); color: var(--news-item-sentiment-negative-text); }
.news-item .sentiment.neutral { background-color: var(--news-item-sentiment-neutral-bg); color: var(--news-item-sentiment-neutral-text); }


/* Auth Pages Specific */
.auth-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-grow: 1;
    padding: 40px 20px;
}
.auth-wrapper .card { max-width: 450px; width: 100%;}
.auth-wrapper .card-body { padding: 35px 40px; }
.auth-wrapper .card-header i { font-size: 1.2rem; color: var(--secondary); } /* Ensure icon color adapts */
.auth-wrapper .btn-primary { padding: 12px 20px; font-weight: 600; font-size: 1rem; }
.auth-wrapper .text-center span { color: var(--text-muted); margin-right: 5px;}


/* Footer */
.main-content { flex-grow: 1; }
.footer {
    background-color: var(--primary);
    color: rgba(255, 255, 255, 0.8);
    padding: 40px 0 20px;
    margin-top: auto;
}
[data-theme="dark"] .footer {
    background-color: #171923; /* Darker footer background */
    color: #a0aec0; /* Lighter text */
}
.footer h5 { color: var(--text-on-primary); font-weight: 600; margin-bottom: 20px; }
[data-theme="dark"] .footer h5 { color: #e2e8f0; }
.footer a { color: var(--accent); text-decoration: none; transition: color 0.2s ease-in-out; }
.footer a:hover { text-decoration: underline; color: var(--text-on-primary); }
[data-theme="dark"] .footer a:hover { color: #ffffff; }
.footer p { margin-bottom: 10px; line-height: 1.6; }
.footer .list-unstyled li { margin-bottom: 10px; }
.footer .small { color: rgba(255, 255, 255, 0.6); font-size: 0.85rem; }
[data-theme="dark"] .footer .small { color: #718096; }
.footer .footer-bottom {
     margin-top: 30px;
     padding-top: 20px;
     border-top: 1px solid rgba(255, 255, 255, 0.2);
}
[data-theme="dark"] .footer .footer-bottom {
    border-top-color: #4a5568;
}

/* Utilities */
/* Re-define text colors using variables for theme adaptability */
.text-success { color: var(--success) !important; }
.text-danger { color: var(--danger) !important; }
.text-warning { color: var(--warning) !important; }
.text-info { color: var(--accent) !important; }
.text-muted { color: var(--text-muted) !important; } /* Ensure this uses the theme variable */

.bg-success { background-color: var(--success) !important; }
.bg-danger { background-color: var(--danger) !important; }
.bg-warning { background-color: var(--warning) !important; }
.bg-info { background-color: var(--accent) !important; }
.bg-light { background-color: var(--light) !important; } /* Will be dark gray in dark mode */
.bg-dark { background-color: var(--dark) !important; }
.bg-secondary { background-color: var(--secondary) !important; }

/* Toast Styling */
#toast-container .toast { border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);}
#toast-container .toast-header { border-bottom: none; background-color: rgba(0,0,0,0.1); color: inherit;}
#toast-container .toast-body { display: flex; align-items: center; }
#toast-container .toast-body i { margin-right: 10px; font-size: 1.2rem; }
/* Ensure toast colors adapt */
#toast-container .bg-success { background-color: var(--success) !important; }
#toast-container .bg-danger { background-color: var(--danger) !important; }
#toast-container .bg-warning { background-color: var(--warning) !important; color: #444 !important; }
#toast-container .bg-info { background-color: var(--accent) !important; }
[data-theme="dark"] #toast-container .bg-warning { color: #1a202c !important; }
[data-theme="dark"] #toast-container .toast {
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    color: #fff !important; /* Ensure text is white on dark toasts */
    background-clip: padding-box; /* Fix potential border issues */
}
[data-theme="dark"] #toast-container .toast-header {
    background-color: rgba(255, 255, 255, 0.1);
    color: #e2e8f0;
}
[data-theme="dark"] #toast-container .btn-close-white { filter: invert(1) grayscale(100%) brightness(200%); }

/* Modal Styling */
.modal-content {
    border-radius: 10px;
    border: 1px solid var(--border-card);
    background-color: var(--bg-card);
    color: var(--text-main);
}
.modal-header {
    background-color: var(--bg-header);
    border-bottom: 1px solid var(--border-header);
    border-radius: 10px 10px 0 0;
    color: var(--text-heading);
}
.modal-title { color: var(--text-heading); font-weight: 600; }
.modal-body { padding: 20px; }
.modal-footer {
    background-color: var(--bg-header);
    border-top: 1px solid var(--border-header);
}
.btn-close { filter: invert(0.5) sepia(1) saturate(20) hue-rotate(190deg) brightness(1.2); }
[data-theme="dark"] .btn-close { filter: invert(1) grayscale(100%) brightness(200%); }

/* ----- Explicit Dark Theme Overrides (To help ensure application) ----- */
[data-theme="dark"] .card {
    background-color: var(--bg-card);   /* Re-apply dark card background */
    color: var(--text-main);           /* Re-apply light text color */
    border-color: var(--border-card);  /* Re-apply dark border color */
    box-shadow: var(--shadow-card);    /* Apply proper shadow */
    transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s, border-color 0.3s, color 0.3s;
}

[data-theme="dark"] .card:hover {
    box-shadow: var(--shadow-card-hover); /* Apply hover shadow explicitly */
}

[data-theme="dark"] .card-header {
    background-color: color-mix(in srgb, var(--bg-header) 93%, var(--primary) 7%); /* Enhanced primary tint */
    color: var(--text-heading);        /* Re-apply light heading color */
    border-bottom-color: var(--border-header); /* Re-apply dark border */
}

[data-theme="dark"] .card-header i {
    color: var(--secondary); /* Ensure icon color is correct in dark mode */
}

[data-theme="dark"] .card-body {
    color: var(--text-main); /* Ensure body text inherits correctly */
    background-color: var(--bg-card); /* Explicitly set the background */
}

/* Special treatment for Quick Stock Analysis card */
[data-theme="dark"] .card.quick-stock-analysis-card {
    background-color: color-mix(in srgb, var(--bg-card) 95%, var(--secondary) 5%); /* Subtle highlight */
    border-color: color-mix(in srgb, var(--border-card) 80%, var(--secondary) 20%); /* Tinted border */
}

[data-theme="dark"] .card.quick-stock-analysis-card .card-header {
    background-color: color-mix(in srgb, var(--bg-header) 90%, var(--secondary) 10%); /* More noticeable header */
    border-bottom-color: color-mix(in srgb, var(--border-header) 80%, var(--secondary) 20%);
}

[data-theme="dark"] .card.quick-stock-analysis-card .card-header i {
    color: var(--secondary); /* Brighter icon */
}

/* Special treatment for Analysis History card */
/* Ensure you ADD class="analysis-history-card" to the div in index.html if you want these */
[data-theme="dark"] .card.analysis-history-card {
    background-color: color-mix(in srgb, var(--bg-card) 97%, var(--primary) 3%); /* Subtle primary tint */
    border-color: color-mix(in srgb, var(--border-card) 85%, var(--primary) 15%); /* Tinted border */
    box-shadow: 0 4px 16px rgba(0,0,0,0.3); /* Enhanced shadow */
}

[data-theme="dark"] .card.analysis-history-card .card-header {
    background-color: color-mix(in srgb, var(--bg-header) 90%, var(--primary) 10%); /* More visible header */
    border-bottom-color: color-mix(in srgb, var(--border-header) 80%, var(--primary) 20%);
    color: #e6f0ff; /* Brighter text */
}

[data-theme="dark"] .card.analysis-history-card .card-header i {
    color: var(--primary); /* Matching icon color */
}


/* ===== START: Stronger Table Overrides for Dark Mode ===== */

/* Ensure table within card adapts */
[data-theme="dark"] .card .table {
    color: var(--text-main);
    background-color: transparent; /* Make table background transparent */
    border-color: var(--border-color); /* Use theme border color */
}

[data-theme="dark"] .card .table thead th {
    background-color: color-mix(in srgb, var(--bg-card) 85%, var(--primary) 15%); /* Darker header, primary tint */
    color: #edf2f7; /* Slightly less bright than main text for subtle hierarchy */
    border-bottom: 2px solid rgba(255, 255, 255, 0.15) !important; /* Stronger border */
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

[data-theme="dark"] .card .table tbody tr {
    background-color: transparent !important; /* Force transparent background for rows */
    color: var(--text-main) !important; /* Force light text */
    border-bottom-color: rgba(255, 255, 255, 0.1); /* More visible row borders */
}

/* Explicitly style table cells */
[data-theme="dark"] .card .table td {
     color: var(--text-main) !important; /* Ensure cell text is light */
     background-color: transparent !important; /* Force transparent background */
     border-top: 1px solid var(--border-color); /* Use border-top for td as tr border might be overridden */
     vertical-align: middle; /* Ensure vertical alignment */
}

/* Ensure first row cells don't have double border */
[data-theme="dark"] .card .table tbody tr:first-child td {
    border-top: none;
}


/* Apply subtle striping to rows using TD background */
[data-theme="dark"] .card .table tbody tr:nth-child(odd) td {
     background-color: rgba(255, 255, 255, 0.03) !important;
}

/* Apply hover effect to TDs */
[data-theme="dark"] .card .table tbody tr:hover td {
     background-color: rgba(255, 255, 255, 0.07) !important;
}

/* Override Bootstrap's default hover color specifically */
[data-theme="dark"] .table-hover > tbody > tr:hover > * {
    --bs-table-accent-bg: rgba(255, 255, 255, 0.07); /* Match TD hover */
    color: var(--text-main); /* Ensure text color stays light */
}

/* Ensure links and specific text colors within the table cells also adapt */
[data-theme="dark"] .card .table td a { color: var(--accent); }
[data-theme="dark"] .card .table td a:hover { color: #76e4d9; }
[data-theme="dark"] .card .table td .text-primary { color: #63b3ed !important; }
[data-theme="dark"] .card .table td .text-success { color: #68d391 !important; }
[data-theme="dark"] .card .table td .text-danger { color: #fc8181 !important; }
[data-theme="dark"] .card .table td .text-muted { color: var(--text-muted) !important; }

/* Action Badges within table cells */
[data-theme="dark"] .card .table .action-badge {
    /* Styles already defined elsewhere, just ensure they apply */
}

/* ===== END: Stronger Table Overrides for Dark Mode ===== */


/* Ensure placeholder text color adapts */
[data-theme="dark"] .text-muted,
[data-theme="dark"] .form-text {
    color: var(--text-muted) !important; /* Use important to override potential Bootstrap specificity */
}

/* Ensure link colors in dark mode have good contrast */
[data-theme="dark"] a {
    color: var(--text-link);
    transition: color 0.2s;
}

[data-theme="dark"] a:hover {
    color: var(--text-link-hover);
}


/* Responsive Adjustments */
@media (max-width: 767.98px) {
    .stats-card h3 { font-size: 1.5rem; }
    .stats-card i { font-size: 1.8rem; }
    .welcome-card { text-align: center; }
    .welcome-card .text-md-end { text-align: center !important; margin-top: 15px; }
    .ticker-tape { animation-duration: 30s; }
    .action-btn-group { flex-direction: column; }
    .auth-wrapper .card-body { padding: 25px 20px; }
    .stock-header { text-align: center; padding: 20px; }
    .stock-header h1 { font-size: 2rem; }
    .price-large { font-size: 2.2rem; }
    .stock-header .text-lg-end { text-align: center !important; }

    /* Ensure table doesn't break layout on small screens */
    .table-responsive {
        border: none; /* Remove border if needed */
    }
}

/* Fix button group alignment in tables */
.table .btn-group, .table .btn-group-sm {
    display: flex;
    align-items: stretch;
}

.table .btn-group .btn, .table .btn-group-sm .btn {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    border-radius: 0;
}

.table .btn-group .btn:first-child, .table .btn-group-sm .btn:first-child {
    border-top-left-radius: 0.375rem;
    border-bottom-left-radius: 0.375rem;
}

.table .btn-group .btn:last-child, .table .btn-group-sm .btn:last-child {
    border-top-right-radius: 0.375rem;
    border-bottom-right-radius: 0.375rem;
}